@attribute [Route(AppRouteConstants.Index)]

<MudContainer>
    <MudGrid Class="pa-4 justify-center mud-text-align-center">
        <MudItem xs="12" sm="12" md="12">
            <div class="d-flex justify-center mt-4">
                <MudIcon Icon="@Icons.Outlined.LensBlur" Color="Color.Primary" Size="Size.Large" Style="width: 250px; height: 250px;"/>
            </div>
        </MudItem>
        <MudItem xs="12" sm="12" md="12">
            <MudText Align="Align.Center" Typo="Typo.h5" Class="smaller">
                Hello @_loggedInUser.Username! Welcome to @ServerState.ApplicationName!
            </MudText>
        </MudItem>
        @if (_canViewApi)
        {
            <MudItem xs="12" sm="12" md="12">
                <MudAlert ContentAlignment="HorizontalAlignment.Center" Severity="Severity.Info">
                    You have access to view our API!
                    <MudLink Target="_blank" Href="@AppRouteConstants.Api.Root">
                        Check out the API documentation using Swagger/OpenApi!
                    </MudLink>
                </MudAlert>
            </MudItem>
        }
        @if (_canViewJobs)
        {
            <MudItem xs="12" sm="12" md="12">
                <MudAlert ContentAlignment="HorizontalAlignment.Center" Severity="Severity.Warning">
                    You have access to view background jobs, execute them and check their status on the
                    <MudLink Target="_blank" Href="@AppRouteConstants.Jobs.Root">Jobs Page</MudLink>
                </MudAlert>
            </MudItem>
        }
        <MudItem xs="12" sm="12" md="12">
            <MudAlert ContentAlignment="HorizontalAlignment.Center" Severity="Severity.Error">
                @ServerState.ApplicationName is a work in progress, more to come!
            </MudAlert>
        </MudItem>
        <MudExpansionPanel Class="mud-theme-appbar-background" Text="Documentation" MaxHeight="150">
            Documentation will be coming soon!
            <MudButton Variant="Variant.Text" DisableElevation="true" Color="Color.Primary" Link="/info/getting-started">
                I'll link to the documentation page!
            </MudButton>
        </MudExpansionPanel>
        <MudButton Color="Color.Primary" OnClick="@(RegisterTotp)" Variant="Variant.Outlined">
            Register TOTP MFA
        </MudButton>
        @if (!string.IsNullOrWhiteSpace(_mfaKey))
        {
            <MudItem xs="12" sm="12" md="12" Class="align-center">
                <MudImage ObjectPosition="ObjectPosition.Center" ObjectFit="ObjectFit.Contain" Src="@_qrCodeSrc" Fluid="true" Width="500" />
                <MudText Align="Align.Center" Typo="Typo.h6" Class="smaller">
                    Totp Key Raw: @_mfaKey
                </MudText>
                <MudTextField T="string" @bind-Value="_totpCode" Placeholder="TOTP Code" Adornment="Adornment.Start"
                              AdornmentIcon="@Icons.Material.Filled.Token" IconSize="Size.Medium" Class="mt-0"/>
                <MudText Align="Align.Center" Typo="Typo.h6" Class="smaller">
                    TOTP Code Correct?: @_totpCorrect
                </MudText>
                <MudButton Color="Color.Tertiary" OnClick="@(CheckTotpCode)" Variant="Variant.Outlined">
                    <MudIcon Icon="@Icons.Material.Filled.Verified"/>
                </MudButton>
            </MudItem>
        }
    </MudGrid>
</MudContainer>
